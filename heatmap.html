<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=lB1LFGD8N6ydaTCSmVxiPYSly973KBHa"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
        ul,li{list-style: none;margin:0;padding:0;float:left;}
        html{height:100%}
        body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
        #container{height:90%;width:100%;}
        #r-result{width:100%;}
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="r-result">
        <input type="button"  onclick="openHeatmap();" value="显示热力图"/><input type="button"  onclick="closeHeatmap();" value="关闭热力图"/>
    </div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例

    var point = new BMap.Point(112.9504641807647,27.835702227135588);
    map.centerAndZoom(point, 12);             // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放

    var points =[
{"lat":30.53095656804304,"lng":117.06360390491879,"count":16},
{"lat":32.921523704350825,"lng":117.39551332813694,"count":4},
{"lat":31.629002428816317,"lng":117.89557620044565,"count":4},
{"lat":30.670883790764535,"lng":117.49842096159624,"count":2},
{"lat":32.26127087204081,"lng":118.33940613596579,"count":2},
{"lat":31.826577833686887,"lng":117.23344266497664,"count":1},
{"lat":32.63184739905333,"lng":117.00638885071616,"count":2},
{"lat":29.721889786591692,"lng":118.34543725314781,"count":1},
{"lat":31.73429415631746,"lng":117.3305404177196,"count":5},
{"lat":31.676265597609103,"lng":118.5135795794315,"count":2},
{"lat":31.73429415631746,"lng":117.3305404177196,"count":6},
{"lat":30.95123323991339,"lng":117.81847679445747,"count":3},
{"lat":31.358536655799266,"lng":118.43943137653523,"count":5},
{"lat":30.94660154529291,"lng":118.76553424276743,"count":6},
{"lat":39.910924547299565,"lng":116.4133836971231,"count":9},
{"lat":39.910924547299565,"lng":116.4133836971231,"count":1},
{"lat":26.080429420698078,"lng":119.30346983854001,"count":13},
{"lat":25.081219844871676,"lng":117.02344756677536,"count":1},
{"lat":27.389104987898513,"lng":118.08735102597767,"count":5},
{"lat":26.672241711408567,"lng":119.55451074542829,"count":2},
{"lat":25.45986545592271,"lng":119.0145209781265,"count":6},
{"lat":24.879952330498313,"lng":118.68244626680422,"count":6},
{"lat":26.269736515991838,"lng":117.64552116782143,"count":2},
{"lat":24.51892979117087,"lng":117.65357645298785,"count":5},
{"lat":36.55082533041454,"lng":104.1444508283435,"count":4},
{"lat":35.586832926561875,"lng":104.63242008306302,"count":6},
{"lat":36.06546488736762,"lng":103.83247812812213,"count":2},
{"lat":36.067234693545565,"lng":103.84052119633628,"count":6},
{"lat":36.06546488736762,"lng":103.83247812812213,"count":4},
{"lat":36.06546488736762,"lng":103.83247812812213,"count":4},
{"lat":35.71521598356201,"lng":107.6493856959542,"count":4},
{"lat":34.58741188165064,"lng":105.73141674566955,"count":6},
{"lat":36.06546488736762,"lng":103.83247812812213,"count":3},
{"lat":38.932066007004934,"lng":100.45641147405634,"count":4},
{"lat":23.02730841164339,"lng":113.75842045787648,"count":1},
{"lat":23.02775875078891,"lng":113.12851219549718,"count":14},
{"lat":23.135336306695006,"lng":113.27143134445974,"count":21},
{"lat":23.749684370959752,"lng":114.70744627290641,"count":8},
{"lat":23.116358854725593,"lng":114.4235580165817,"count":2},
{"lat":22.584603880965,"lng":113.08855619524043,"count":4},
{"lat":23.555740488275585,"lng":116.37851218033846,"count":10},
{"lat":21.669064031332095,"lng":110.931542579969,"count":9},
{"lat":24.294177532206206,"lng":116.12953737612247,"count":4},
{"lat":23.688230292088083,"lng":113.06246832527266,"count":10},
{"lat":23.35909171772515,"lng":116.68852864054833,"count":2},
{"lat":22.79126303654673,"lng":115.38155260365083,"count":5},
{"lat":24.815881278583017,"lng":113.60352734562261,"count":12},
{"lat":22.548456637984177,"lng":114.06455183658751,"count":17},
{"lat":21.864339726138933,"lng":111.98848929181268,"count":5},
{"lat":21.276723439012073,"lng":110.36555441392824,"count":12},
{"lat":23.052888771125616,"lng":112.47148894063035,"count":17},
{"lat":22.5223146707905,"lng":113.39942236263188,"count":1},
{"lat":22.27656465424921,"lng":113.58255478654918,"count":1},
{"lat":23.908185934295958,"lng":106.62458932565383,"count":3},
{"lat":21.48683649576942,"lng":109.126533212566,"count":5},
{"lat":21.6930052899694,"lng":108.360418838298,"count":2},
{"lat":25.24169878354397,"lng":110.18619487315159,"count":10},
{"lat":25.24169878354397,"lng":110.18619487315159,"count":13},
{"lat":24.698911731272894,"lng":108.09149994498661,"count":6},
{"lat":24.331961386852413,"lng":109.43442194634564,"count":43},
{"lat":24.331961386852413,"lng":109.43442194634564,"count":6},
{"lat":22.821268997908664,"lng":108.3345212294372,"count":7},
{"lat":22.822606601187154,"lng":108.37345082581861,"count":4},
{"lat":23.48274528113516,"lng":111.28551681182014,"count":9},
{"lat":23.48274528113516,"lng":111.28551681182014,"count":9},
{"lat":22.659830509953142,"lng":110.1884531233724,"count":6},
{"lat":26.25925237871499,"lng":105.95441712388904,"count":3},
{"lat":27.29021508342595,"lng":105.2985887950112,"count":14},
{"lat":26.653324822309752,"lng":106.63657676352776,"count":2},
{"lat":26.598833108257494,"lng":104.8375546023468,"count":6},
{"lat":26.58970296982603,"lng":107.9894462407788,"count":9},
{"lat":26.260616196073833,"lng":107.5284027057371,"count":10},
{"lat":25.09396734941651,"lng":104.91249214626991,"count":3},
{"lat":26.604029544994923,"lng":106.71447593088575,"count":7},
{"lat":26.604029544994923,"lng":106.71447593088575,"count":20},
{"lat":20.052113086180366,"lng":110.2067198964201,"count":5},
{"lat":18.258736291747855,"lng":109.51855670139908,"count":21},
{"lat":18.258736291747855,"lng":109.51855670139908,"count":8},
{"lat":38.04320164520046,"lng":114.53659630531568,"count":1},
{"lat":38.87998776845534,"lng":115.47146383768579,"count":10},
{"lat":38.24569687459607,"lng":116.7421971104011,"count":3},
{"lat":40.95785601233803,"lng":117.96939750996681,"count":2},
{"lat":36.631262731204046,"lng":114.5456282282352,"count":4},
{"lat":37.745191408077424,"lng":115.6754061376161,"count":1},
{"lat":39.89472719832739,"lng":119.5259671942601,"count":1},
{"lat":38.0483119268727,"lng":114.52153190157445,"count":8},
{"lat":39.63658372414733,"lng":118.18645947203979,"count":4},
{"lat":37.07668595096609,"lng":114.51146225612979,"count":3},
{"lat":40.7732372026915,"lng":114.89257223145165,"count":1},
{"lat":36.10594098401491,"lng":114.39950042177432,"count":4},
{"lat":35.7523574114,"lng":114.30359364247649,"count":1},
{"lat":35.22096325403899,"lng":113.24854783457334,"count":4},
{"lat":34.80288581121172,"lng":114.31459258497121,"count":2},
{"lat":34.62426277921943,"lng":112.4594212983115,"count":22},
{"lat":33.5877107071022,"lng":114.02342077764726,"count":6},
{"lat":32.99656220465144,"lng":112.53450131351325,"count":4},
{"lat":33.772050748691015,"lng":113.19952856052156,"count":9},
{"lat":35.76759302890629,"lng":115.03559747034215,"count":1},
{"lat":34.778327249459984,"lng":111.2065332238741,"count":1},
{"lat":34.4202016658586,"lng":115.66244933826238,"count":3},
{"lat":35.3096399303368,"lng":113.93360046733228,"count":5},
{"lat":32.15301454753105,"lng":114.09748283304512,"count":6},
{"lat":34.04143161161871,"lng":113.85847553685502,"count":5},
{"lat":34.75343885045448,"lng":113.63141920733915,"count":6},
{"lat":33.643083575264406,"lng":114.7079826661061,"count":22},
{"lat":33.01784241674367,"lng":114.02847078173271,"count":23},
{"lat":46.59363317672175,"lng":125.10865763402039,"count":3},
{"lat":50.42002595502784,"lng":124.15292785448057,"count":3},
{"lat":45.808825827952184,"lng":126.54161509031663,"count":4},
{"lat":47.35605615768509,"lng":130.3044328986694,"count":4},
{"lat":45.300872317823895,"lng":130.97561865876668,"count":1},
{"lat":46.80568999085779,"lng":130.327359092573,"count":4},
{"lat":44.55624570898632,"lng":129.6395397783469,"count":4},
{"lat":45.77630032154785,"lng":131.01154459102744,"count":1},
{"lat":47.3599771860153,"lng":123.92457086841536,"count":2},
{"lat":46.65318589588607,"lng":131.16534168078073,"count":1},
{"lat":45.96833752464142,"lng":126.85721568717256,"count":2},
{"lat":46.6600321798244,"lng":126.97535687530133,"count":4},
{"lat":30.39657217331699,"lng":114.90160738827099,"count":5},
{"lat":30.30103714374126,"lng":109.4865502690053,"count":18},
{"lat":30.551600064658352,"lng":114.34844073658718,"count":9},
{"lat":30.205207848941598,"lng":115.04553290894361,"count":10},
{"lat":31.041732575569622,"lng":112.20639298023002,"count":13},
{"lat":30.340842107742912,"lng":112.24552262926137,"count":9},
{"lat":30.33169887683693,"lng":112.25861327613607,"count":1},
{"lat":32.63506185840116,"lng":110.80452956069568,"count":16},
{"lat":30.598466736400987,"lng":114.31158155473231,"count":57},
{"lat":29.847055947646492,"lng":114.32851909026844,"count":27},
{"lat":30.551600064658352,"lng":114.34844073658718,"count":29},
{"lat":30.924526261070227,"lng":113.96346265773938,"count":19},
{"lat":30.697446484492378,"lng":111.29254921035434,"count":11},
{"lat":29.037749999406877,"lng":111.70545217995837,"count":617},
{"lat":25.776683273601865,"lng":113.02146049909462,"count":42},
{"lat":28.118269998009367,"lng":112.98960254334654,"count":119},
{"lat":26.899576139189122,"lng":112.57844721325992,"count":1630},
{"lat":27.575160902978517,"lng":110.00851426537254,"count":83},
{"lat":26.227682089778906,"lng":111.63750237493397,"count":81},
{"lat":27.703208596991583,"lng":112.00150349288418,"count":1328},
{"lat":27.245270272808565,"lng":111.474432885931,"count":753},
{"lat":27.835702227135585,"lng":112.95046418076468,"count":2659},
{"lat":28.317369104701186,"lng":109.74557664946683,"count":160},
{"lat":28.559711178489888,"lng":112.36151595471031,"count":578},
{"lat":29.3631782939259,"lng":113.13548942422142,"count":1572},
{"lat":28.23488939994364,"lng":112.94547319535287,"count":5001},
{"lat":27.833567639016444,"lng":113.14047079776427,"count":1535},
{"lat":45.62550435999602,"lng":122.8455906084976,"count":1},
{"lat":43.84356783457924,"lng":126.55563450495482,"count":3},
{"lat":42.89405500574631,"lng":125.15042516688747,"count":1},
{"lat":43.171993571561,"lng":124.35648155715893,"count":2},
{"lat":45.14740419341382,"lng":124.83148187569292,"count":2},
{"lat":41.733815801613424,"lng":125.94660627598029,"count":4},
{"lat":43.82195350104314,"lng":125.3306020759069,"count":5},
{"lat":31.815795653327836,"lng":119.98148471327892,"count":2},
{"lat":33.63815042476756,"lng":119.0414217411613,"count":3},
{"lat":34.60224952526725,"lng":119.22862133316607,"count":7},
{"lat":32.06465288561847,"lng":118.80242172124585,"count":7},
{"lat":31.98654943120089,"lng":120.90159173866185,"count":4},
{"lat":31.303564074441766,"lng":120.59241222959322,"count":4},
{"lat":34.21266655011306,"lng":117.29057543439453,"count":7},
{"lat":33.355100917626196,"lng":120.167544265761,"count":1},
{"lat":32.40067693609037,"lng":119.41941890822997,"count":7},
{"lat":32.19471592052375,"lng":119.43048944567383,"count":5},
{"lat":27.954892253419565,"lng":116.36453876864373,"count":16},
{"lat":25.835176103497655,"lng":114.9405033729825,"count":6},
{"lat":28.68169051676075,"lng":115.91542320365122,"count":46},
{"lat":29.274247711040953,"lng":117.18457644638579,"count":8},
{"lat":29.666660847999456,"lng":115.96066124030492,"count":18},
{"lat":28.68945529506072,"lng":115.86458944231661,"count":21},
{"lat":27.664752547951164,"lng":113.89369655407103,"count":736},
{"lat":28.460625921851733,"lng":117.94945960312224,"count":17},
{"lat":27.823578697788587,"lng":114.9235346513963,"count":352},
{"lat":28.68169051676075,"lng":115.91542320365122,"count":776},
{"lat":28.265787063191418,"lng":117.0755754270272,"count":1},
{"lat":41.49291646055291,"lng":123.69250712420832,"count":1},
{"lat":41.57982086475567,"lng":120.45749949793277,"count":4},
{"lat":38.9189536667856,"lng":121.62163148459285,"count":3},
{"lat":40.00640870559368,"lng":124.36154728159079,"count":1},
{"lat":41.88596959305694,"lng":123.9643746156145,"count":1},
{"lat":41.84146525120185,"lng":123.43559785683209,"count":1},
{"lat":41.10093149946208,"lng":121.13259630055518,"count":1},
{"lat":41.27416129045421,"lng":123.24336640651318,"count":2},
{"lat":40.72579099974712,"lng":122.1771181899173,"count":1},
{"lat":41.68383006919066,"lng":123.47109664482264,"count":3},
{"lat":42.22994799718447,"lng":123.73236520917769,"count":3},
{"lat":40.63070304275062,"lng":122.22579880279181,"count":2},
{"lat":40.823156232446166,"lng":111.77260583081977,"count":1},
{"lat":40.66292878826139,"lng":109.84654350721243,"count":1},
{"lat":42.2616861034116,"lng":118.8955203975195,"count":9},
{"lat":40.84842299711348,"lng":111.75550856170946,"count":1},
{"lat":40.823156232446166,"lng":111.77260583081977,"count":4},
{"lat":40.823156232446166,"lng":111.77260583081977,"count":2},
{"lat":43.93942266533856,"lng":116.05439144074573,"count":1},
{"lat":46.08846371321896,"lng":122.04436452582519,"count":2},
{"lat":45.54837043664955,"lng":120.92472246699802,"count":3},
{"lat":36.02161725801098,"lng":106.24857742607188,"count":2},
{"lat":37.38275046252745,"lng":97.37629911601906,"count":4},
{"lat":36.62338469651661,"lng":101.78445017050855,"count":2},
{"lat":36.674856650404905,"lng":117.02744162847857,"count":3},
{"lat":36.674856650404905,"lng":117.02744162847857,"count":3},
{"lat":35.420177394529645,"lng":116.59361234853988,"count":25},
{"lat":36.674856650404905,"lng":117.02744162847857,"count":2},
{"lat":36.072227496663224,"lng":120.38945519114627,"count":2},
{"lat":35.42283899843767,"lng":119.53341540456555,"count":1},
{"lat":36.2058580448846,"lng":117.0944948347959,"count":1},
{"lat":37.5164305480148,"lng":122.12754097831325,"count":1},
{"lat":36.71265155126753,"lng":119.16837791142822,"count":9},
{"lat":37.470038383730525,"lng":121.45441541730195,"count":3},
{"lat":34.815994048435115,"lng":117.33054194483897,"count":6},
{"lat":36.81908568332188,"lng":118.06145253489896,"count":2},
{"lat":40.102783001859564,"lng":113.37336244450448,"count":5},
{"lat":35.49628458647257,"lng":112.85857823132879,"count":2},
{"lat":37.87982942385603,"lng":112.56937550968271,"count":2},
{"lat":36.093741895419726,"lng":111.52553022403073,"count":2},
{"lat":37.87982942385603,"lng":112.56937550968271,"count":1},
{"lat":39.337108370541735,"lng":112.4393709396677,"count":1},
{"lat":37.87698902884778,"lng":112.55639149167204,"count":3},
{"lat":37.87982942385603,"lng":112.56937550968271,"count":4},
{"lat":37.862360847859385,"lng":113.58761666287546,"count":2},
{"lat":35.03270691290923,"lng":111.01338945447925,"count":7},
{"lat":36.2012683721548,"lng":113.12255886984902,"count":2},
{"lat":34.27580800602361,"lng":108.96039314875111,"count":2},
{"lat":34.36891564286998,"lng":107.2445753670404,"count":9},
{"lat":33.073799907833795,"lng":107.02943020926463,"count":7},
{"lat":34.27580800602361,"lng":108.96039314875111,"count":1},
{"lat":34.34726881662395,"lng":108.94646555063274,"count":9},
{"lat":34.335476293368586,"lng":108.71542245143303,"count":8},
{"lat":38.290883835484046,"lng":109.74161603381395,"count":1},
{"lat":31.235929042252014,"lng":121.48053886017651,"count":12},
{"lat":31.235929042252014,"lng":121.48053886017651,"count":2},
{"lat":31.905511577266523,"lng":102.23141546175019,"count":1},
{"lat":31.872888585956545,"lng":106.7515853031645,"count":3},
{"lat":30.578993724029967,"lng":104.07274727406208,"count":12},
{"lat":31.20239336055401,"lng":107.51841059666617,"count":8},
{"lat":31.133115003656755,"lng":104.40441936496448,"count":3},
{"lat":29.70927819797873,"lng":107.39641979754104,"count":1},
{"lat":32.44161630531542,"lng":105.85042318166482,"count":3},
{"lat":29.55794071745811,"lng":103.7725376036347,"count":2},
{"lat":27.88775230036972,"lng":102.2735026809702,"count":3},
{"lat":28.87766830360723,"lng":105.4485240693266,"count":2},
{"lat":31.473663048745863,"lng":104.6855618607612,"count":8},
{"lat":30.843782508337036,"lng":106.11750261487227,"count":9},
{"lat":29.58588653832045,"lng":105.06458802499718,"count":8},
{"lat":26.58803317333301,"lng":101.72554117091441,"count":1},
{"lat":29.53881256766016,"lng":108.77759119834955,"count":3},
{"lat":30.53909767110912,"lng":105.5994215306444,"count":3},
{"lat":30.577543147015334,"lng":104.07346654728391,"count":3},
{"lat":30.577543147015334,"lng":104.07346654728391,"count":2},
{"lat":30.49185373362993,"lng":103.89070305737907,"count":2},
{"lat":29.568996245338923,"lng":106.55843415537664,"count":6},
{"lat":29.345584921327575,"lng":104.78444884671711,"count":5},
{"lat":39.09110259843554,"lng":117.2080927529767,"count":10},
{"lat":39.09110259843554,"lng":117.2080927529767,"count":2},
{"lat":29.65948787983075,"lng":91.17845425628477,"count":2},
{"lat":29.655702997622964,"lng":91.1362320108882,"count":1},
{"lat":47.85072787010195,"lng":88.14792620373527,"count":4},
{"lat":41.7702873304504,"lng":86.1517138653326,"count":4},
{"lat":44.01685415991987,"lng":87.3150016244744,"count":3},
{"lat":42.82582436811265,"lng":93.52121554028504,"count":2},
{"lat":37.12044646304192,"lng":79.9285070635119,"count":1},
{"lat":39.88624710609514,"lng":116.37749100216642,"count":2},
{"lat":43.830763204290484,"lng":87.62443993536046,"count":3},
{"lat":43.79923810128996,"lng":87.63347320573824,"count":1},
{"lat":25.051773565340376,"lng":101.53441248050268,"count":2},
{"lat":25.6121284181925,"lng":100.27458284048366,"count":3},
{"lat":23.36999624760546,"lng":103.38154905257933,"count":3},
{"lat":25.051562267344867,"lng":102.71641607523223,"count":1},
{"lat":25.823707417657754,"lng":98.8632883813579,"count":1},
{"lat":25.051562267344867,"lng":102.71641607523223,"count":8},
{"lat":25.051562267344867,"lng":102.71641607523223,"count":2},
{"lat":23.391944131908,"lng":104.23854382746465,"count":3},
{"lat":25.051562267344867,"lng":102.71641607523223,"count":7},
{"lat":30.25308298169347,"lng":120.21551180372168,"count":5},
{"lat":28.131986007185745,"lng":121.00542622668624,"count":1},
{"lat":30.750974830920143,"lng":120.76355182586005,"count":1},
{"lat":29.084639385513697,"lng":119.65343619052916,"count":3},
{"lat":28.473278180563412,"lng":119.9295730584414,"count":1},
{"lat":29.866068124069646,"lng":121.63084278185603,"count":1},
{"lat":28.975545802265025,"lng":118.86659674035565,"count":10},
{"lat":30.0363693113069,"lng":120.58547847885335,"count":1},
{"lat":28.66219405599615,"lng":121.42743470427969,"count":1},
{"lat":28.00108540447221,"lng":120.70647689035565,"count":18},
{"lat":29.99091168016034,"lng":122.21355631852045,"count":1},
];

    if(!isSupportCanvas()){
        alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
    //详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
    //参数说明如下:
    /* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *  {
            .2:'rgb(0, 255, 255)',
            .5:'rgb(0, 110, 255)',
            .8:'rgb(100, 0, 255)'
        }
        其中 key 表示插值的位置, 0~1.
            value 为颜色值.
     */
    heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":20});
    map.addOverlay(heatmapOverlay);
    heatmapOverlay.setDataSet({data:points,max:100});
    //是否显示热力图
    function openHeatmap(){
        heatmapOverlay.show();
    }
    function closeHeatmap(){
        heatmapOverlay.hide();
    }
    closeHeatmap();
    function setGradient(){
        /*格式如下所示:
        {
            0:'rgb(102, 255, 0)',
            .5:'rgb(255, 170, 0)',
            1:'rgb(255, 0, 0)'
        }*/
        var gradient = {
            0:'rgb(0, 255, 255)',
            .5:'rgb(0, 110, 255)',
            1:'rgb(100, 0, 255)'
        };
        var colors = document.querySelectorAll("input[type='color']");
        colors = [].slice.call(colors,0);
        colors.forEach(function(ele){
            gradient[ele.getAttribute("data-key")] = ele.value;
        });
        heatmapOverlay.setOptions({"gradient":gradient});
    }
    //判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>